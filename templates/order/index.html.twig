{% extends 'base.html.twig' %}

{% block title %}Valider ma commande{% endblock %}

    
  
{% block body %}
{% block header %}
    <header class="container-fluid">

        <nav class="navbar navbar-expand-lg navbar-light">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            {% block images %}
            <div class="d-inline-block">
                <img src="{{ asset('images/logo.png') }}" alt="logo"/>
            </div>
            {% endblock %}
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto m-1 p-1">
                    <li class="nav-item active">
                        <a class="nav-link active" href="/home" tabindex="-1" aria-disabled="true">Accueil </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/product" tabindex="-1"
                            aria-disabled="true">Nos Produits</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/service" tabindex="-1"
                            aria-disabled="true">Nos services 3.0</a>
                    </li>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/" tabindex="-1"
                            aria-disabled="true">Qui sommes nous?</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/contact" tabindex="-1"
                            aria-disabled="true">Contact</a>
                    </li>
                
                </ul>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <li class="nav-item"> 
                                   <a href="{{ path('cart')}}"><img src="{{ asset('images/shopping-cart.png') }}" class="cart-icon" alt="mon_panier"></a>

                           </li> 
                        <li class="nav-item">
                            {% if app.user %}
                           <div class="text-center mb-3">
                             <h5><a href={{ path('mon_compte') }} id="connecter">Mon compte</a></h5> 
                             <a href="{{ path('app_logout') }}">Logout</a>
                             </div>
                            {% else %}
                            <div class="text-center mb-3">
                                <button type="button" class="btn btn-outline-success"> <a href="/login" tabindex="-1"
                                        aria-disabled="true" active aria-current="page"
                                        id="connection">Connexion</a></button>
                                <button type="button" class="btn btn-outline-success"><a href="/register" tabindex="-1"
                                        aria-disabled="true" active aria-current="page">S'inscrire</a></button>
                            </div>
                          {% endif %}
                    </li>
                    
            </div>
        </nav>
    </header>
{% endblock %}

{% block main %}
<div class="row">
<h2>Je passe ma commande</h2>

<p>Réglez mes préference avant de passer à l'étape suivante</p>
<hr>
<div class="col-md-6">

{% set formHtml %}
<p>Pas d'adresse enregistrer?<a href="{{ path('adress_new')}}">En crééer une</a></p>
{{ form(form) }}




{% endset %}
{{ formHtml | replace({('[br]') : '<br>'})| raw }}

</div>
<div class="col-md-6">
<div class="text-center">
<b>Recapitulatif de ma commande</b><br>
<p>Retrouvez ici le récapitulatif de votre commande</p>
</div>
<div class="order-summary">
{% set total = null %}
{%  for key,product in cart %}
    <div class="row {% if key > 0 %}mt-2{% endif %}">
        <div class="col-2">
            <img src="{{ asset('upload/' ~  product.product.image) }}" 
            height="50px"alt="{{product.product.name}}">
        </div>
        <div class="col-3 my-auto">{{product.product.name}}</div>
        <div class="col-1 my-auto">{{product.product.price}}€</div>
        <div class="col-2 my-auto">
            x {{product.quantity}}
  </div>
    
  </div>
{% set total = total + (product.product.price * product.quantity ) %}
{% endfor %}
   <p class="mt-2">Total à payer : {{ total }} €</p> 
</div>
</div>
<div>
{% endblock %}
{% endblock %}